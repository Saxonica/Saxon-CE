<?xml version="1.0" encoding="utf-8"?>
<article id="api" title="JavaScript API">
   <h1>JavaScript API</h1>
      
      <p>The JavaScript API for Saxon-CE is loaded using a standard HTML <code>script</code> element:</p>
      <samp><![CDATA[<script type="text/javascript" language="javascript" src="../Saxon/Saxon.nocache.js"></script>
]]></samp>
      <p>When using this API, it's important to ensure the Saxon-CE library is loaded first. 
The global <code>onSaxonLoad</code> callback function is provided to facilitate this during an HTML page load. 
Saxon-CE will make a call to this once it has loaded.</p>
      <p>The API is centred around 2 principal objects:</p>
      <h2 class="subtitle">XSLT20Processor</h2>
      <p>
         <a class="bodylink" href="/api/xslt20processor">XSLT20Processor</a>
is modeled on the JavaScript XSLTProcessor API as implemented by Opera, Mozilla, Safari and Chrome browsers (<a href="http://www.dev.abiss.gr/sarissa/" class="bodylink">Sarissa</a> provides a wrapper compatible with Internet Explorer). It provides a set of methods used to initiate XSLT transforms on XML or direct XSLT-based HTML updates. 
This standard API has been extended to: (a) access functionality new to XSLT 2.0, (b) provide extra features specific to HTML processing, and (c) support asynchronous processing.</p>
      <h2 class="subtitle">Saxon</h2>
      <p>The <a class="bodylink" href="/api/saxon">Saxon</a> object provides a factory method for instantiating <code>XSLT20Processor</code> and a <code>run</code> function for invoking transforms more declaratively by using a JavaScript literal object to describe the transform. 
It also includes a small set of utility functions for managing XML resources and controlling the logging of messages from <code>XSLT20Processor</code> object instances.</p>
      <h2 class="subtitle"> </h2>
      <p>Links to all JavaScript API Sections:</p>
      <ul>
      <li>
         <p><a class="bodylink" href="command">Command</a></p>
      </li>
      <li>
         <p><a class="bodylink" href="saxon">Saxon</a></p>
      </li>
      <li>
         <p><a class="bodylink" href="xslt20processor">XSLT20Processor</a></p>
      </li>
   </ul>
   <section id="command" title="Command">
      <h1>Command</h1>
      
      <p>The Command object is used exclusively by the Saxon object's 
<a class="bodylink" href="/api/saxon/run">run</a>
function. It's designed to be used as a JavaScript literal object 
and effectively wraps the Saxon-CE API with a set of properties so you can run an XSLT transform on an HTML page in a more declarative way.</p>
      <p>If you need to include a namespace in an XSLT parameter name, use the Clark notation: <code>{uri}local</code> - for example <code>{http://saxonica.com/units}mass-kg</code>
      </p>
      <p>In the properties listed below, only <code>stylesheet</code> (shown in italics) is mandatory, but either <code>initialTemplate</code> or 
<code>source</code> must also be set, to ensure that the stylesheet has an entry point.</p>
      <h2 class="subtitle">Properties</h2>
      <table>
         <thead>
            <tr>
               <td>
                  <p>
                     <strong>Property</strong>
                  </p>
               </td>
               <td>
                  <p>
                     <strong>Type</strong>
                  </p>
               </td>
               <td>
                  <p>
                     <strong>Description</strong>
                  </p>
               </td>
            </tr>
         </thead>
         <tr>
            <td valign="top">
               <p>errorHandler</p>
            </td>
            <td valign="top">
               <p>Function</p>
            </td>
            <td valign="top">
               <p>The callback function for handling processing errors.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>initialMode</p>
            </td>
            <td valign="top">
               <p>String</p>
            </td>
            <td valign="top">
               <p>The initial mode for the transform</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>initialTemplate</p>
            </td>
            <td valign="top">
               <p>String</p>
            </td>
            <td valign="top">
               <p>The initial template for the transform</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>logLevel</p>
            </td>
            <td valign="top">
               <p>String</p>
            </td>
            <td valign="top">
               <p>Sets the error and event logging threshold.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>method</p>
            </td>
            <td valign="top">
               <p>String</p>
            </td>
            <td valign="top">
               <p>The transform method to use [Default: updateHTMLDocument]</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>parameters</p>
            </td>
            <td valign="top">
               <p>Map:Name→Value</p>
            </td>
            <td valign="top">
               <p>XSLT parameters are set from the matching values of properties of the parameters object.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>source</p>
            </td>
            <td valign="top">
               <p>String|Document</p>
            </td>
            <td valign="top">
               <p>The XML document source for the transform</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <i>stylesheet</i>
               </p>
            </td>
            <td valign="top">
               <p>String|Document</p>
            </td>
            <td valign="top">
               <p>Sets the stylesheet for the transform</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>success</p>
            </td>
            <td valign="top">
               <p>Function</p>
            </td>
            <td valign="top">
               <p>The success callback function - called after a transform.</p>
            </td>
         </tr>
      </table>
      <h2 class="subtitle">Notes</h2>
      <p>An example of how the literal <code>Command</code> object can be used with the Saxon <code>run</code> method is shown below. 
This sample also shows how to use the <code>onSaxonLoad</code> function to ensure the Saxon-CE library loads fully before any JavaScript API calls are made on the library.</p>
      <samp><![CDATA[
// Using Saxon.run method with the Command object to start an HTML page transform:

var onSaxonLoad = function() {
    Saxon.run( {
         stylesheet:   "display-geo.xsl",
         source:       "geo-files.xml",
         initialMode:  "pull",
         
         parameters: {
                        mass-kg: 225,
                        point: [128, 79],
                        label: "Definitions"
                     },
                     
         errorHandler:  saxonHandler    
    });
}

// equivalent using the procedural JavaScript API:

var onSaxonLoad = function() {
    var xml = Saxon.requestXML(geo-files.xml);
    var xsl = Saxon.requestXML("display-geo.xsl");
    
    var proc = new XSLT20Processor(xsl);
    
    proc.setParameter(null, "mass-kg", 225);
    proc.setParameter(null, "point", [128, 79]);
    proc.setParameter(null, "label", "Definitions");
    
    proc.setErrorHandler(saxonHandler);
    proc.updateHTMLDocument(xml, null);
}
]]></samp>
   </section>
   <section id="saxon" title="Saxon">
      <h1>Saxon</h1>
      
      <p>This is used as a static object, providing a set of utility functions for:</p>
      <ul>
         <li>
            <p>Creating new instances of the 
<a class="bodylink" href="/api/xslt20processor">XSLT20Processor</a>
object</p>
         </li>
         <li>
            <p>Initiating a simple XSLT transform declaratively</p>
         </li>
         <li>
            <p>Working with XML resources</p>
         </li>
         <li>
            <p>Configuration and house-keeping tasks</p>
         </li>
      </ul>
      <h2 class="subtitle">Functions</h2>
      <table>
         <thead>
            <tr>
               <td>
                  <p>
                     <strong>Function</strong>
                  </p>
               </td>
               <td>
                  <p>
                     <strong>Description</strong>
                  </p>
               </td>
            </tr>
         </thead>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/saxon/getErrorHandler">getErrorHandler()</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns a reference to the function set as the Saxon error handler.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/saxon/getLogLevel">getLogLevel()</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns the level at which events, warning and errors are logged.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/saxon/getVersion">getVersion()</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns the version number of the Saxon-CE processor.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/saxon/newXSLT20Processor">newXSLT20Processor(xslt)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>The factory method for creating a new
XSLT20Processor
 object.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/saxon/parseXML">parseXML(arg)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns a new XML document object created from the lexical XML String passed as an argument.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/saxon/requestXML">requestXML(uri)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Emulates an XMLHTTPRequest, effectively returning an XML document object.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/saxon/run">run(cmd)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Uses JavaScript literal object properties to execute an XSLT transform.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/saxon/serializeXML">serializeXML(xml)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns a String that represents a serialization of the XML Node argument.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/saxon/setErrorHandler">setErrorHandler(handler)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Sets a callback function to allow your own code to manage events and errors occurring in the XSLT20Processor object.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/saxon/setLogLevel">setLogLevel(level)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Sets the level at which events, warning and errors are logged.</p>
            </td>
         </tr>
      </table>
      <section id="getErrorHandler" title="getErrorHandler">
         <h1>getErrorHandler</h1>
         
         <h2 class="subtitle">getErrorHandler() → Function</h2>
         <p>Returns a reference to the function set as the Saxon error handler.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>There are no arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>Function</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>This function corresponds to the <a class="bodylink" href="/api/saxon/setErrorHandler">setErrorHandler</a> function and returns <code>null</code> if no error handler was set.</p>
      </section>
      <section id="getLogLevel" title="getLogLevel">
         <h1>getLogLevel</h1>
         
         <h2 class="subtitle">getLogLevel() → String</h2>
         <p>Returns the level at which events, warning and errors are logged.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>There are no arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>String</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>There are 7 logging levels, ranging from SEVERE to FINEST. See 
the <a class="bodylink" href="/coding/logging">Logging</a> section fur further details.
</p>
         <p>Note that the log level is set using <code>
               <a class="bodylink" href="/api/saxon/setLogLevel">setLogLevel</a>
            </code> or by a <code>logLevel</code> URI argument.</p>
      </section>
      <section id="getVersion" title="getVersion">
         <h1>getVersion</h1>
         
         <h2 class="subtitle">getVersion() → String</h2>
         <p>Returns the version number of the Saxon-CE processor.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>There are no arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>String</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
      </section>
      <section id="newXSLT20Processor" title="newXSLT20Processor">
         <h1>newXSLT20Processor</h1>
         
         <h2 class="subtitle">newXSLT20Processor($xslt as Document?) → XSLT20Processor</h2>
         <p>The factory method for creating a new
<a class="bodylink" href="/api/xslt20processor">XSLT20Processor</a>
 object.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$xslt</p>
               </td>
               <td valign="top" width="150">
                  <p>Document?</p>
               </td>
               <td valign="top" width="200">
                  <p>The XML Document containing the stylesheet.</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>XSLT20Processor</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>The optional <code>xslt</code> argument is used to specify the stylesheet to be used when one of the transform functions of this object is called. The function,
<a class="bodylink" href="/api/saxon/requestXML">requestXML</a>,
provides a cross-browser method for getting a Document instance of the stylesheet.
</p>
         <p> If the <code>xslt</code> argument is null when XSLT20Procssor is initialised using this function, the <a class="bodylink" href="/api/xslt20processor/importStylesheet">importStylesheet</a> function should always be called first, before initiating a transform.</p>
         <p>It's possible to use a number of XSLT20Processor instances. This may be useful either when you want to exploit a number of previously compiled stylesheets, or when working with different HTML target pages (events from the host page are broadcast to all processors that have stylesheets with <code>ixsl:event</code> templates).</p>
      </section>
      <section id="parseXML" title="parseXML">
         <h1>parseXML</h1>
         
         <h2 class="subtitle">parseXML($arg as String) → Document</h2>
         <p>Returns a new XML document object created from the lexical XML String passed as an argument.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$arg</p>
               </td>
               <td valign="top" width="150">
                  <p>String</p>
               </td>
               <td valign="top" width="200">
                  <p>The XML string to be converted.</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>Document</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>This is a cross-browser method for parsing an XML string and converting it to an XML document object.</p>
      </section>
      <section id="requestXML" title="requestXML">
         <h1>requestXML</h1>
         
         <h2 class="subtitle">requestXML($uri as String) → Document</h2>
         <p>Emulates an XMLHTTPRequest, effectively returning an XML document object.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$uri</p>
               </td>
               <td valign="top" width="150">
                  <p>String</p>
               </td>
               <td valign="top" width="200">
                  <p>The URI of the document to fetch</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>Document</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>This method creates a placeholder for a document object that can be used as an argument wherever a
<code>Document</code> object is required by an API method, such as <code>transformToDocument()</code>. The use of such a placeholder allows Saxon-CE to determine whether to retrieve the document synchonously or asynchronously, depending on the context in which it is used.</p>
         <p>
            <i>Note: Typically, XML resources that are used as XSLT stylesheets are fetched synchronously, whilst those loaded as data are fetched asynchronously while the XSLT compiles.</i>
         </p>
      </section>
      <section id="run" title="run">
         <h1>run</h1>
         
         <h2 class="subtitle">run($cmd as Command?) → XSLT20Processor</h2>
         <p>Uses JavaScript literal object properties to execute an XSLT transform.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$cmd</p>
               </td>
               <td valign="top" width="150">
                  <p>Command?</p>
               </td>
               <td valign="top" width="200">
                  <p>The URI of the stylesheet.</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>XSLT20Processor</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>A call to this function uses a single <a class="bodylink" href="/api/command">Command</a> object parameter to describe the XSLT transform to run. The Command object is designed to be used as JavaScript literal:</p>
         <samp><![CDATA[
var onSaxonLoad = function() {

    var xrows = document.getElementById("extra").getElementsByTagName("tr");

    Saxon.run( {
         stylesheet:   "display-geo.xsl",
         source:       "geo-files.xml"
         
         parameters: {
                        mass: 225,
                        rows: xrows,
                        title: "Intro"
                     },   
    });
}
]]></samp>
         <p>This function returns a newly created <a class="bodylink" href="/api/xslt20processor">XSLT20Processor</a> object. Use this object's <code>getResultDocument</code> and <code>getResultDocuments</code> functions to get any output results from the tranform. Note that the principal output document is returned by a call to <code>getResultDocumemt</code> with no parameter value.</p>
         <p>The <code>run</code> method serves as a wrapper for the 3 lower-level transform calls of the API: <code>transformToDocument, transformToFragment</code> and <code>updateHTMLDocument</code>. The latter of these is the default function, use the <code>method</code> property with the function name to specify an alternative transform.</p>
      </section>
      <section id="serializeXML" title="serializeXML">
         <h1>serializeXML</h1>
         
         <h2 class="subtitle">serializeXML($xml as Node) → String</h2>
         <p>Returns a String that represents a serialization of the XML Node argument.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$xml</p>
               </td>
               <td valign="top" width="150">
                  <p>Node</p>
               </td>
               <td valign="top" width="200">
                  <p>The Node to serialize</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>String</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>This method provides a simple cross-browser wrapper for serialising a XML DOM node. Results may therefore vary according to the host browser used. For example, when serialising a DocumentFragment containing a number of top-level elements, Internet Explorer only serializes the first element.</p>
      </section>
      <section id="setErrorHandler" title="setErrorHandler">
         <h1>setErrorHandler</h1>
         
         <h2 class="subtitle">setErrorHandler($handler as Function) → </h2>
         <p>Sets a callback function to allow your own code to manage events and errors occurring in the XSLT20Processor object.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$handler</p>
               </td>
               <td valign="top" width="150">
                  <p>Function</p>
               </td>
               <td valign="top" width="200">
                  <p>The function to which callbacks will be made on events or errors</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p/>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>The error and event handling capability this callback provides is for use with the Debug variant of Saxon only. The threshold for this callback is controlled by the Logging
<a class="bodylink" href="/api/saxon/setLogLevel">setLogLevel</a>
method, or a URI argument - see the
<a class="bodylink" href="/coding/logging">Logging</a>
section for further details.</p>
         <p>The <code>$handler</code> function argument signature should hava a single <code>error</code> argument. The <code>error</code> object which is passed in the callback can then be used to get details on the error or event. It has 3 properties: <code>message</code>, <code>level</code> and <code>time</code>. If no error handler is set, any JavaScript or XSLT exceptions are thrown so that your code can manage them.</p>
         <p>
            <i>Sample JavaScript code:</i>
         </p>
         <samp><![CDATA[
var errors = new Array();

function doPageUpdate() {

    errors = new Array();
    // ------ SET ERROR HANDLER --------
    Saxon.setErrorHandler(handler);
    Saxon.setLogLevel("FINE");

    (...)
    
    // update the HTML page
    var result = proc.updateHTMLDocument(xml);

    // show a window alert listing any compile-time or run-time errors
    if (errors.length > 0) {
        window.alert(errors.toString());
    }                     
}
// ------ DECLARE ERROR HANDLER --------
function handler(saxonError) {
   errors.push(saxonError.message + " " + saxonError.level + " " + saxonError.time);
}
]]></samp>
      </section>
      <section id="setLogLevel" title="setLogLevel">
         <h1>setLogLevel</h1>
         
         <h2 class="subtitle">setLogLevel($level as String?) → </h2>
         <p>Sets the level at which events, warning and errors are logged.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$level</p>
               </td>
               <td valign="top" width="150">
                  <p>String?</p>
               </td>
               <td valign="top" width="200">
                  <p>The threshold at which events or errors are logged.</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p/>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>There are 7 logging levels, ranging from SEVERE to FINEST. See 
the <a class="bodylink" href="/coding/logging">Logging</a> section fur further details.
</p>
      </section>
   </section>
   <section id="xslt20processor" title="XSLT20Processor">
      <h1>XSLT20Processor</h1>
      
      <p>The XSLT20Processor object provides the various functions used to perform an XSLT 2.0 transform. This section describes all the available functions, but the following (along with the object constructor) are probably going to be used most often:</p>
      <table>
         <tr>
            <td>
               <p>
                  <strong>1. Configure:</strong>
               </p>
            </td>
            <td>
               <p>setParameter</p>
            </td>
            <td>
               <p>setInitialTemplate</p>
            </td>
            <td>
               <p>setMode</p>
            </td>
         </tr>
         <tr>
            <td>
               <p>
                  <strong>2. Transform:</strong>
               </p>
            </td>
            <td>
               <p>updateHTMLDocument</p>
            </td>
            <td>
               <p>transformToDocument</p>
            </td>
            <td>
               <p>transformToFragment</p>
            </td>
         </tr>
      </table>
      <p>
         <i>When using the API on page-load, you should ensure Saxon-CE is loaded first by including your code within the global <code>onSaxonLoad</code> function. This function is called as soon as the HTML page has loaded and Saxon-CE has been initialized.</i>
      </p>
      <p>XSLT20Processor instances are created using the <a class="bodylink" href="/api/saxon/newXSLT20Processor">newXSLT20Processor</a> factory method of the static
<a class="bodylink" href="/api/saxon">Saxon</a>
object (which also provides a set of XML utility functions along with functions for controlling error logging).
</p>
      <h2 class="subtitle">Functions</h2>
      <table>
         <thead>
            <tr>
               <td>
                  <p>
                     <strong>Function</strong>
                  </p>
               </td>
               <td>
                  <p>
                     <strong>Description</strong>
                  </p>
               </td>
            </tr>
         </thead>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/clearParameters">clearParameters()</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Removes all parameters set for the XSLT20Processor instance.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/getInitialMode">getInitialMode()</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Gets the initial mode set for the XSLT transform.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/getInitialTemplate">getInitialTemplate()</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Gets the name set for the XSLT transform initial template</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/getParameter">getParameter(namespace, name)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Gets the value of the named XSLT transform parameter.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/getResultDocument">getResultDocument(uri)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns a result document created by the xsl:result-document instruction</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/getResultDocuments">getResultDocuments()</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns any array of result document URIs that were output by the previous XSLT transform.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/getSuccess">getSuccess()</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns the callback function set by setSuccess</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/importStylesheet">importStylesheet(xsl)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Sets the stylesheet to be used for an XSLT transform</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/removeParameter">removeParameter(name)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Removes the named parameter.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/reset">reset()</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Resets the XSLT20Processor object to its original state.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/setBaseOutputURI">setBaseOutputURI(uri)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Set the base URI for resolving output URIs from an XSLT transform</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/setInitialMode">setInitialMode(name)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Sets the name for the initial mode to be called for the XSLT transform</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/setInitialTemplate">setInitialTemplate(name)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Sets the name for the initial template to be called for the XSLT transform</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/setParameter">setParameter(namespace, name, value)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Sets named parameters for the XSLT transform</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/setSuccess">setSuccess(callback)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Following a transform, a callback is made to this function</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/transformToDocument">transformToDocument(source)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns the result of an XSLT transform as a Document object.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/transformToFragment">transformToFragment(source, ownerDocument)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns the result of an XSLT transform as a DocumentFragment object.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/transformToHTMLFragment">transformToHTMLFragment(source, ownerDocument)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Returns the result of an XSLT transform as one or more HTML DocumentFragment objects.</p>
            </td>
         </tr>
         <tr>
            <td valign="top">
               <p>
                  <code>
                     <a class="bodylink" href="/api/xslt20processor/updateHTMLDocument">updateHTMLDocument(source, target)</a>
                  </code>
               </p>
            </td>
            <td valign="top">
               <p>Initiates an XSLT transform on an existing HTML document.</p>
            </td>
         </tr>
      </table>
      <section id="clearParameters" title="clearParameters">
         <h1>clearParameters</h1>
         
         <h2 class="subtitle">clearParameters() → </h2>
         <p>Removes all parameters set for the XSLT20Processor instance.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>There are no arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p/>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>See: <a href="../setParameter" class="bodylink">setParameter</a> and <a href="../getParameter" class="bodylink">getParameter</a>
         </p>
      </section>
      <section id="getInitialMode" title="getInitialMode">
         <h1>getInitialMode</h1>
         
         <h2 class="subtitle">getInitialMode() → String</h2>
         <p>Gets the initial mode set for the XSLT transform.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>There are no arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>String</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>If the returned name has a namespace, then the result is formatted using the James-Clark notation: <code>{uri}local</code>.</p>
      </section>
      <section id="getInitialTemplate" title="getInitialTemplate">
         <h1>getInitialTemplate</h1>
         
         <h2 class="subtitle">getInitialTemplate() → String</h2>
         <p>Gets the name set for the XSLT transform initial template</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>There are no arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>String</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>If the returned name has a namespace, then the James-Clark notation is used: <code>{uri}local</code>.</p>
      </section>
      <section id="getParameter" title="getParameter">
         <h1>getParameter</h1>
         
         <h2 class="subtitle">getParameter($namespace as String, $name as String) → Object</h2>
         <p>Gets the value of the named XSLT transform parameter.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$namespace</p>
               </td>
               <td valign="top" width="150">
                  <p>String</p>
               </td>
               <td valign="top" width="200">
                  <p>The namespace for the parameter name or null</p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$name</p>
               </td>
               <td valign="top" width="150">
                  <p>String</p>
               </td>
               <td valign="top" width="200">
                  <p>The parameter name</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>Object</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>This is the counterpart to the <a href="../setParameter" class="bodylink">setParameter</a> method</p>
      </section>
      <section id="getResultDocument" title="getResultDocument">
         <h1>getResultDocument</h1>
         
         <h2 class="subtitle">getResultDocument($uri as String) → Document|DocumentFragment</h2>
         <p>Returns a result document created by the <i>xsl:result-document</i> instruction</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$uri</p>
               </td>
               <td valign="top" width="150">
                  <p>String</p>
               </td>
               <td valign="top" width="200">
                  <p>The URI of the result document</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>Document|DocumentFragment</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>Result documents created when calling the <code>XSLT20Processor</code> functions <a class="bodylink" href="/api/xslt20processor/transformToDocument">transformToDocument</a> or <a class="bodylink" href="/api/xslt20processor/transformToFragment">transformToFragment</a> each have a unique URI. The <code>uri</code> parameter identifies the specific document to return, the result is <code>null</code> if no result document was output with a matching URI.</p>
         <p>When getResultDocument is called with no parameter or a null or empty-string parameter value, the principal output document, if any, is returned.</p>
         <p>This function can be used in combination with <a class="bodylink" href="/api/xslt20processor/getResultDocuments">GetResultDocuments()</a> which returns a String array of all result document URIs from the last XSLT transform.</p>
      </section>
      <section id="getResultDocuments" title="getResultDocuments">
         <h1>getResultDocuments</h1>
         
         <h2 class="subtitle">getResultDocuments() → String Array</h2>
         <p>Returns any array of result document URIs that were output by the previous XSLT transform.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>There are no arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>String Array</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>Note: You can use the <a class="bodylink" href="/api/xslt20processor/getResultDocuments">getResultDocument(uri)</a> function to get a reference to the <code>Document</code> or <code>DocumentFragment</code> identified by each URI.</p>
      </section>
      <section id="getSuccess" title="getSuccess">
         <h1>getSuccess</h1>
         
         <h2 class="subtitle">getSuccess() → Function</h2>
         <p>Returns the callback function set by <code>setSuccess</code>
         </p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>There are no arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>Function</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
      </section>
      <section id="importStylesheet" title="importStylesheet">
         <h1>importStylesheet</h1>
         
         <h2 class="subtitle">importStylesheet($xsl as Document) → </h2>
         <p>Sets the stylesheet to be used for an XSLT transform</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$xsl</p>
               </td>
               <td valign="top" width="150">
                  <p>Document</p>
               </td>
               <td valign="top" width="200">
                  <p>The XML Document containing the stylesheet to import</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p/>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>Note that the XSLT20Processor
<a class="bodylink" href="/api/xslt20processor/_Constructor">constructor</a>
  can also be used to set the stylesheet.</p>
      </section>
      <section id="removeParameter" title="removeParameter">
         <h1>removeParameter</h1>
         
         <h2 class="subtitle">removeParameter($name as String) → </h2>
         <p>Removes the named parameter.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$name</p>
               </td>
               <td valign="top" width="150">
                  <p>String</p>
               </td>
               <td valign="top" width="200">
                  <p>The parameter name</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p/>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>See: <a href="../setParameter" class="bodylink">setParameter</a> and <a href="../getParameter" class="bodylink">getParameter</a>
         </p>
      </section>
      <section id="reset" title="reset">
         <h1>reset</h1>
         
         <h2 class="subtitle">reset() → </h2>
         <p>Resets the XSLT20Processor object to its original state.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>There are no arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p/>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>Clears the XSLT20Processor instance settings for parameters, imported stylesheet, initial template and initial mode</p>
      </section>
      <section id="setBaseOutputURI" title="setBaseOutputURI">
         <h1>setBaseOutputURI</h1>
         
         <h2 class="subtitle">setBaseOutputURI($uri as String?) → </h2>
         <p>Set the base URI for resolving output URIs from an XSLT transform</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$uri</p>
               </td>
               <td valign="top" width="150">
                  <p>String?</p>
               </td>
               <td valign="top" width="200">
                  <p>The base URI for output documents</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p/>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>If no uri is supplied, the base output uri is reset.</p>
      </section>
      <section id="setInitialMode" title="setInitialMode">
         <h1>setInitialMode</h1>
         
         <h2 class="subtitle">setInitialMode($name as String) → </h2>
         <p>Sets the name for the initial mode to be called for the XSLT transform</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$name</p>
               </td>
               <td valign="top" width="150">
                  <p>String</p>
               </td>
               <td valign="top" width="200">
                  <p>The mode name</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p/>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>To set a namespace-qualified name, use the James-Clark notation: <code>{uri}local</code>.</p>
      </section>
      <section id="setInitialTemplate" title="setInitialTemplate">
         <h1>setInitialTemplate</h1>
         
         <h2 class="subtitle">setInitialTemplate($name as String) → </h2>
         <p>Sets the name for the initial template to be called for the XSLT transform</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$name</p>
               </td>
               <td valign="top" width="150">
                  <p>String</p>
               </td>
               <td valign="top" width="200">
                  <p>The template name</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p/>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>To set a namespace-qualified name, use the James-Clark notation: <code>{uri}local</code>.</p>
      </section>
      <section id="setParameter" title="setParameter">
         <h1>setParameter</h1>
         
         <h2 class="subtitle">setParameter($namespace as String, $name as String, $value as Object) → Void</h2>
         <p>Sets named parameters for the XSLT transform</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$namespace</p>
               </td>
               <td valign="top" width="150">
                  <p>String</p>
               </td>
               <td valign="top" width="200">
                  <p>The namespace for the parameter name or null</p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$name</p>
               </td>
               <td valign="top" width="150">
                  <p>String</p>
               </td>
               <td valign="top" width="200">
                  <p>The parameter name</p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$value</p>
               </td>
               <td valign="top" width="150">
                  <p>Object</p>
               </td>
               <td valign="top" width="200">
                  <p>The parameter value</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>Void</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>Supplied parameter types may be <code>String</code>, <code>Double</code>, <code>Node</code> or <code>Array</code>. Array items may be any of these types, except<code> Array</code>.</p>
         <p>
            <i>Sample JavaScript code:</i>
         </p>
         <samp><![CDATA[
    ...
    // initialise processor
    var proc = new XSLT20Processor(xsl);
    
    // a node parameter:
    proc.setParameter(null, "fElementArray", document.getElementsByTagName("h2"));
    // a string array parameter
    proc.setParameter(null, "fArray", ["one", "two"]);
    // a string parameter
    proc.setParameter(null, "fString", "my value");
    
    var result = proc.transformToDocument(Saxon.requestXML('data.xml'));
]]></samp>
      </section>
      <section id="setSuccess" title="setSuccess">
         <h1>setSuccess</h1>
         
         <h2 class="subtitle">setSuccess($callback as Function) → </h2>
         <p>Following a transform, a callback is made to this function</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$callback</p>
               </td>
               <td valign="top" width="150">
                  <p>Function</p>
               </td>
               <td valign="top" width="200">
                  <p>The callback function</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p/>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>The callback function has the signature <code>success(proc)</code> where <code>proc</code> is the instance of XSLT20Processor performing the transform.</p>
         <p>If <code>success</code> is not set, then processing will be synchronous for calls to <code>transformToDocument</code> and <code>transformToFragment</code>. The
<code>updateHTMLDocument</code> function can potentially always run asynchronously as it has no return values (it simply updates the target HTML document).
</p>
      </section>
      <section id="transformToDocument" title="transformToDocument">
         <h1>transformToDocument</h1>
         
         <h2 class="subtitle">transformToDocument($source as Node?) → Document</h2>
         <p>Returns the result of an XSLT transform as a Document object.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$source</p>
               </td>
               <td valign="top" width="150">
                  <p>Node?</p>
               </td>
               <td valign="top" width="200">
                  <p>The source document or node to be transformed.</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>Document</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>If no source document is supplied then an initialTemplate must be set.</p>
      </section>
      <section id="transformToFragment" title="transformToFragment">
         <h1>transformToFragment</h1>
         
         <h2 class="subtitle">transformToFragment($source as Node?, $ownerDocument as Document?) → DocumentFragment</h2>
         <p>Returns the result of an XSLT transform as a DocumentFragment object.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$source</p>
               </td>
               <td valign="top" width="150">
                  <p>Node?</p>
               </td>
               <td valign="top" width="200">
                  <p>The source document or node to be transformed.</p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$ownerDocument</p>
               </td>
               <td valign="top" width="150">
                  <p>Document?</p>
               </td>
               <td valign="top" width="200">
                  <p>The owner document for the fragment</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>DocumentFragment</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>If no source document is supplied then an initialTemplate must be set. A DocumentFragment is useful because it can be it allows a set of nodes to be appended to the DOM without a container element.</p>
         <p>All DocumentFragments must have an owner document, if none is supplied as a parameter a new XML document is created for this purpose.</p>
      </section>
      <section id="transformToHTMLFragment" title="transformToHTMLFragment">
         <h1>transformToHTMLFragment</h1>
         
         <h2 class="subtitle">transformToHTMLFragment($source as Node?, $ownerDocument as Document?) → DocumentFragment</h2>
         <p>Returns the result of an XSLT transform as one or more HTML DocumentFragment objects.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$source</p>
               </td>
               <td valign="top" width="150">
                  <p>Node?</p>
               </td>
               <td valign="top" width="200">
                  <p>The source document or node to be transformed</p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$ownerDocument</p>
               </td>
               <td valign="top" width="150">
                  <p>Document?</p>
               </td>
               <td valign="top" width="200">
                  <p>The owner document for the HTML fragment</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>DocumentFragment</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>If no source document is supplied then an initialTemplate must be set. All DocumentFragments must have an owner document, if none is supplied as a parameter the owner is set to the host HTML document.</p>
         <p>This function returns a collection of HTML fragments that can be appended directly to the DOM. Each returned fragment can contain a number of nodes, but can be appended to an HTML DOM element as a single node. The
<a class="bodylink" href="/api/xslt20processor/getResultDocument">getResultDocument</a> and <a class="bodylink" href="/api/xslt20processor/getResultDocument">getResultDocuments</a> functions are used to retrieve each result fragment. Note that the <a class="bodylink" href="/api/xslt20processor/updateHTMLDocument">updateHTMLDocument</a> function provides similar functionality, but fragment updates are peformed entirely within the XSLT using the <code>xsl:result-document</code> instruction's <code>href</code> attribute to specify the target node for each result fragment.
 </p>
      </section>
      <section id="updateHTMLDocument" title="updateHTMLDocument">
         <h1>updateHTMLDocument</h1>
         
         <h2 class="subtitle">updateHTMLDocument($source as Node?, $target as Document?) → String</h2>
         <p>Initiates an XSLT transform on an existing HTML document.</p>
         <table>
            <tr>
               <td width="470"
                   align="left"
                   colspan="4"
                   style="border-top:solid 1px #3D5B96; ">
                  <p>
                     <i>Arguments</i>
                  </p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$source</p>
               </td>
               <td valign="top" width="150">
                  <p>Node?</p>
               </td>
               <td valign="top" width="200">
                  <p>The source document or node to be transformed</p>
               </td>
            </tr>
            <tr>
               <td width="40">
                  <p> </p>
               </td>
               <td width="80" valign="top">
                  <p>$target</p>
               </td>
               <td valign="top" width="150">
                  <p>Document?</p>
               </td>
               <td valign="top" width="200">
                  <p>The HTML Document object to update</p>
               </td>
            </tr>
            <tr>
               <td colspan="2"
                   style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;">
                  <p>
                     <i>Result</i>
                  </p>
               </td>
               <td style="border-top:solid 1px #3D5B96; border-bottom:solid 1px #3D5B96;"
                   colspan="2">
                  <p>String</p>
               </td>
            </tr>
         </table>
         <h2 class="subtitle">Details</h2>
         <p>The initial template must be set (using <code>setInitialTemplate</code>) when the <code>source</code> parameter is <code>null</code>. If the <code>target</code> parameter value is null, then the host HTML page is the target for all output.</p>
         <p>updateHTMLDocument() is most commonly used with <code>xsl:result-document</code> to update parts of the document identified by the <code>href</code> attribute. The principal XSLT output (if any) is inserted at the end of the HTML <code>body</code> element.</p>
         <p>
            <i>Note: An error is raised if the source is set to the same document as the target. To read nodes in the HTML you're updating within the XSLT, use the <code>ixsl:page()</code> function which returns the Document node of the host page.</i>
         </p>
      </section>
   </section>
</article>
